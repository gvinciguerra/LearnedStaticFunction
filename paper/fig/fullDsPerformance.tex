% IMPORT-DATA bench data/bench.txt
% SQL DELETE FROM bench WHERE quant != "float16"
% SQL DELETE FROM bench WHERE comp == "ours" AND storage_name != "Filtered-Fano50"
% SQL ALTER TABLE bench ADD ds_and_model float
% SQL UPDATE bench SET ds_and_model = storage_bits + COALESCE(model_bits, 0)

\addtolength\tabcolsep{-1.9pt}
\centering

	\begin{tabular}{ll rrr}
		\toprule
        \multirow{2}{*}{Dataset ($H_0$)} & \multirow{2}{*}{Competitor} & Constr. & Space    & Query \\
                                         &                             & ns/key  & bits/key & ns/key  \\

		
		%% TABULAR REFORMAT(col 3=(precision=4) col 2,4=(precision=0))
		%% SELECT
		%%    IIF(comp == "ours",
		%%    "\midrule\multirow{"||
		%%    	(SELECT COUNT(DISTINCT inner.comp) FROM bench AS inner WHERE outer.dataset_name==inner.dataset_name)
		%%	||"}{*}{" ||
		%%    CASE
		%%      WHEN outer.dataset_name=="gaussian0" THEN "gauss $\sigma$=0.25"
		%%      WHEN outer.dataset_name=="gaussian1" THEN "gauss $\sigma$=0.5"
		%%      WHEN outer.dataset_name=="gaussian2" THEN "gauss $\sigma$=0.75"
		%%      WHEN outer.dataset_name=="gaussian3" THEN "gauss $\sigma$=1"
		%%      ELSE outer.dataset_name
		%%    END || " (" || ROUND(outer.entropy, 2) || ")}","") AS ds,
		%%  IIF(outer.comp!="ours", IIF(outer.comp=="ourCSF","\textbf{Ours} (CSF)",outer.comp), "\textbf{Ours} (" || IIF(outer.dataset_name LIKE "gaussian%", "GNB", IIF(outer.model_l==0, "LR", "L" || outer.model_l || " U" || outer.model_h)) || ")") AS name,
		%%  1000.0 * 1000.0 * (1000.0 * COALESCE(outer.training_seconds, 0) + outer.construct_ms) / outer.size,
		%%  ROUND(ds_and_model, 4),
		%%  outer.query_nanos
		%% FROM bench AS outer
		%% WHERE NOT outer.dataset_name LIKE "gaussian%" AND (comp != "ours" OR ds_and_model == (SELECT MIN(inner.ds_and_model) FROM bench AS inner WHERE outer.dataset_name==inner.dataset_name))
		%% ORDER BY outer.dataset_name, comp DESC
  \midrule\multirow{4}{*}{covertype (1.74)} & \textbf{Ours} (L2 U50) & 119573 & 0.6360 &  916 \\
                                            &    \textbf{Ours} (CSF) &    324 & 1.8020 &   58 \\
                                            &                    GOV &    997 & 1.9404 &  197 \\
                                            &                   BuRR &     68 & 3.0471 &   10 \\
       \midrule\multirow{4}{*}{nids (2.38)} & \textbf{Ours} (L2 U50) &  33262 & 1.1573 &  935 \\
                                            &    \textbf{Ours} (CSF) &    392 & 2.4451 &   68 \\
                                            &                    GOV &   1021 & 2.5642 &  156 \\
                                            &                   BuRR &     69 & 4.0541 &   14 \\
      \midrule\multirow{4}{*}{songs (6.25)} & \textbf{Ours} (L2 U50) &  34448 & 4.1005 & 1847 \\
                                            &    \textbf{Ours} (CSF) &    866 & 6.3102 &   68 \\
                                            &                    GOV &   6811 & 6.5181 &  177 \\
                                            &                   BuRR &     67 & 7.0823 &   17 \\
       \midrule\multirow{4}{*}{urls (0.99)} &     \textbf{Ours} (LR) & 102578 & 0.0526 &  202 \\
                                            &    \textbf{Ours} (CSF) &    262 & 1.0180 &   22 \\
                                            &                    GOV &   1191 & 1.0941 &  100 \\
                                            &                   BuRR &     64 & 1.0266 &    5 \\
  % END TABULAR SELECT    IIF(comp == "ours",    "\midrule\multirow{"||    	(...)})
              
\midrule

		%% TABULAR REFORMAT(col 3=(precision=4) col 2,4=(precision=0))
		%% SELECT
		%%    IIF(comp == "ours",
		%%    "\multirow{"||
		%%    	1
		%%	||"}{*}{" ||
		%%    CASE
		%%      WHEN outer.dataset_name=="gaussian0" THEN "gauss $\sigma$=0.25"
		%%      WHEN outer.dataset_name=="gaussian1" THEN "gauss $\sigma$=0.5"
		%%      WHEN outer.dataset_name=="gaussian2" THEN "gauss $\sigma$=0.75"
		%%      WHEN outer.dataset_name=="gaussian3" THEN "gauss $\sigma$=1"
		%%      ELSE outer.dataset_name
		%%    END || " (" || ROUND(outer.entropy, 2) || ")}","") AS ds,
		%%  IIF(outer.comp!="ours", IIF(outer.comp=="ourCSF","\textbf{Ours} (CSF)",outer.comp), "\textbf{Ours} (" || IIF(outer.dataset_name LIKE "gaussian%", "GNB", IIF(outer.model_l==0, "LR", "L" || outer.model_l || " U" || outer.model_h)) || ")") AS name,
		%%  1000.0 * 1000.0 * (1000.0 * COALESCE(outer.training_seconds, 0) + outer.construct_ms) / outer.size,
		%%  ROUND(ds_and_model, 4),
		%%  outer.query_nanos
		%% FROM bench AS outer
		%% WHERE outer.dataset_name LIKE "gaussian%" AND comp == "ours" AND ds_and_model == (SELECT MIN(inner.ds_and_model) FROM bench AS inner WHERE outer.dataset_name==inner.dataset_name)
		%% ORDER BY outer.dataset_name, comp DESC
  \multirow{1}{*}{gauss $\sigma$=0.25 (3.0)} & \textbf{Ours} (GNB) & 183 & 0.0006 & 179 \\
   \multirow{1}{*}{gauss $\sigma$=0.5 (3.0)} & \textbf{Ours} (GNB) & 269 & 0.1665 & 212 \\
  \multirow{1}{*}{gauss $\sigma$=0.75 (3.0)} & \textbf{Ours} (GNB) & 370 & 0.6066 & 240 \\
     \multirow{1}{*}{gauss $\sigma$=1 (3.0)} & \textbf{Ours} (GNB) & 407 & 0.9845 & 235 \\
  % END TABULAR SELECT    IIF(comp == "ours",    "\multirow{"||    	1	||"}{*}{...})


\midrule\multirow{3}{*}{gauss any $\sigma$}

		%% TABULAR REFORMAT(col 3=(precision=4) col 2,4=(precision=0))
		%% SELECT
		%%    "" AS ds,
		%%  IIF(outer.comp!="ours", IIF(outer.comp=="ourCSF","\textbf{Ours} (CSF)",outer.comp), "\textbf{Ours} (" || IIF(outer.dataset_name LIKE "gaussian%", "GNB", IIF(outer.model_l==0, "LR", "L" || outer.model_l || " U" || outer.model_h)) || ")") AS name,
		%%  1000.0 * 1000.0 * (1000.0 * COALESCE(outer.training_seconds, 0) + outer.construct_ms) / outer.size,
		%%  ROUND(ds_and_model, 4),
		%%  outer.query_nanos
		%% FROM bench AS outer
		%% WHERE outer.dataset_name == "gaussian0" AND comp != "ours"
		%% ORDER BY outer.dataset_name, comp DESC
   & \textbf{Ours} (CSF) &  681 & 3.0159 &  73 \\
   &                 GOV & 1150 & 3.1485 & 114 \\
   &                BuRR &   69 & 3.0454 &  27 \\
  % END TABULAR SELECT    "" AS ds,  IIF(outer.comp!="ours", IIF(outer.comp==...))

		\bottomrule

	\end{tabular}

